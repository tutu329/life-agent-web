<!DOCTYPE html>
<html>
<head>
    <title>OnlyOffice æµ‹è¯•é¡µé¢</title>
    <meta charset="UTF-8">
</head>
<body>
    <h1>OnlyOffice è¿æ¥æµ‹è¯•</h1>
    <div id="placeholder" style="height: 600px; width: 100%;"></div>
    
    <script type="text/javascript" src="http://localhost:8080/web-apps/apps/api/documents/api.js"></script>
    <script type="text/javascript">
        window.docEditor = new DocsAPI.DocEditor("placeholder", {
            width: "100%",
            height: "600px",
            type: "desktop",
            documentType: "word",
            document: {
                fileType: "docx",
                key: "test_document_" + Date.now(),
                title: "æµ‹è¯•æ–‡æ¡£.docx",
                url: "http://192.168.77.63:5173/empty.docx",
                permissions: {
                    edit: true,
                    print: true,
                    download: true,
                    copy: true,
                    comment: true,
                    review: true
                }
            },
            editorConfig: {
                mode: "edit",
                lang: "zh",
                user: {
                    id: "test_user",
                    name: "æµ‹è¯•ç”¨æˆ·"
                }
            },
            events: {
                onAppReady: function() {
                    console.log("âœ… OnlyOffice æµ‹è¯•æˆåŠŸï¼");
                    document.getElementById("status").innerHTML = "âœ… OnlyOfficeåº”ç”¨å·²å‡†å¤‡å°±ç»ª";
                },
                onDocumentReady: function() {
                    console.log("ğŸ“„ æ–‡æ¡£åŠ è½½å®Œæˆ");
                    document.getElementById("status").innerHTML = "âœ… æ–‡æ¡£åŠ è½½æˆåŠŸï¼Œå¯ä»¥å¼€å§‹ç¼–è¾‘";
                },
                onInfo: function(event) {
                    console.log("â„¹ï¸ OnlyOffice ä¿¡æ¯:", event);
                },
                onWarning: function(event) {
                    console.warn("âš ï¸ OnlyOffice è­¦å‘Š:", event);
                },
                onError: function(event) {
                    console.error("âŒ OnlyOffice é”™è¯¯:", event);
                    document.getElementById("status").innerHTML = "âŒ è¿æ¥å¤±è´¥: " + JSON.stringify(event);
                }
            }
        });
    </script>
    
    <div id="status" style="margin-top: 20px; padding: 10px; background: #f0f0f0;">
        ğŸ”„ æ­£åœ¨è¿æ¥ OnlyOffice...
    </div>
</body>
</html> 