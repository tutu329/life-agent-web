<!DOCTYPE html>
<html>
<head>
    <title>ç®€å•OnlyOfficeæµ‹è¯•</title>
    <meta charset="UTF-8">
    <style>
        body { margin: 20px; font-family: Arial, sans-serif; }
        #status { padding: 10px; margin: 10px 0; background: #f0f8ff; border-radius: 4px; }
        #placeholder { border: 2px dashed #ddd; margin: 20px 0; }
    </style>
</head>
<body>
    <h1>ğŸ§ª ç®€å•OnlyOfficeæµ‹è¯•</h1>
    <div id="status">ğŸ”„ æ­£åœ¨åŠ è½½OnlyOffice API...</div>
    <div id="placeholder" style="height: 600px; width: 100%;"></div>
    
    <script>
        console.log('ğŸš€ å¼€å§‹åŠ è½½OnlyOfficeæµ‹è¯•é¡µé¢');
        
        // åŠ¨æ€åŠ è½½OnlyOffice API
        const script = document.createElement('script');
        script.src = 'http://powerai.cc:5102/web-apps/apps/api/documents/api.js';
        script.onload = function() {
            console.log('âœ… OnlyOffice API è„šæœ¬åŠ è½½æˆåŠŸ');
            initEditor();
        };
        script.onerror = function() {
            console.error('âŒ OnlyOffice API è„šæœ¬åŠ è½½å¤±è´¥');
            document.getElementById('status').innerHTML = 'âŒ OnlyOffice API è„šæœ¬åŠ è½½å¤±è´¥';
        };
        document.head.appendChild(script);
        
        function initEditor() {
            try {
                console.log('ğŸ“ åˆå§‹åŒ–OnlyOfficeç¼–è¾‘å™¨...');
                document.getElementById('status').innerHTML = 'ğŸ“ æ­£åœ¨åˆå§‹åŒ–ç¼–è¾‘å™¨...';
                
                window.docEditor = new DocsAPI.DocEditor("placeholder", {
                    width: "100%",
                    height: "600px",
                    type: "desktop",
                    documentType: "word",
                    document: {
                        fileType: "docx",
                        key: "simple_test_" + Date.now(),
                        title: "ç®€å•æµ‹è¯•æ–‡æ¡£.docx",
                        url: "http://powerai.cc:5101/empty.docx",
                        permissions: {
                            edit: true,
                            print: true,
                            download: true
                        }
                    },
                    editorConfig: {
                        mode: "edit",
                        lang: "zh",
                        user: {
                            id: "test_user",
                            name: "æµ‹è¯•ç”¨æˆ·"
                        }
                    },
                    events: {
                        onAppReady: function() {
                            console.log("âœ… OnlyOfficeåº”ç”¨å‡†å¤‡å°±ç»ªï¼");
                            document.getElementById('status').innerHTML = 'âœ… OnlyOfficeç¼–è¾‘å™¨åŠ è½½æˆåŠŸï¼';
                        },
                        onDocumentReady: function() {
                            console.log("ğŸ“„ æ–‡æ¡£åŠ è½½å®Œæˆ");
                        },
                        onInfo: function(event) {
                            console.log("â„¹ï¸ OnlyOfficeä¿¡æ¯:", event);
                        },
                        onWarning: function(event) {
                            console.warn("âš ï¸ OnlyOfficeè­¦å‘Š:", event);
                        },
                        onError: function(event) {
                            console.error("âŒ OnlyOfficeé”™è¯¯:", event);
                            document.getElementById('status').innerHTML = 'âŒ OnlyOfficeé”™è¯¯: ' + JSON.stringify(event);
                        }
                    }
                });
            } catch (error) {
                console.error('âŒ åˆå§‹åŒ–ç¼–è¾‘å™¨æ—¶å‡ºé”™:', error);
                document.getElementById('status').innerHTML = 'âŒ åˆå§‹åŒ–ç¼–è¾‘å™¨å¤±è´¥: ' + error.message;
            }
        }
    </script>
</body>
</html> 