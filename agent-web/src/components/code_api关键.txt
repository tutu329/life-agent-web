1. ä½¿ç”¨äº†æ­£ç¡®çš„å®˜æ–¹APIæ ¼å¼
// âœ… æ­£ç¡®çš„Action_Pasteæ ¼å¼
{
  MessageId: 'Action_Paste',
  SendTime: Date.now(),
  Values: {
    Mimetype: 'text/plain;charset=utf-8',
    Data: insertText
  }
}

// âœ… æ­£ç¡®çš„Send_UNO_Commandæ ¼å¼
{
  MessageId: 'Send_UNO_Command',
  SendTime: Date.now(),
  Values: {
    Command: '.uno:InsertText',
    Args: {
      Text: {
        type: 'string',
        value: insertText
      }
    }
  }
}

2. æ­£ç¡®çš„PostMessageç›®æ ‡åœ°å€
ä» '*' æ”¹ä¸º 'https://powerai.cc:5102' (CODEæœåŠ¡å™¨åœ°å€)
è¿™ç¡®ä¿äº†æ¶ˆæ¯å‘é€åˆ°æ­£ç¡®çš„iframeæº

3. æ­£ç¡®çš„Host_PostmessageReadyåˆå§‹åŒ–
// âœ… å¤šé‡å‘é€ç¡®ä¿åˆå§‹åŒ–æˆåŠŸ
iframeRef.current.contentWindow?.postMessage(readyMessage, 'https://powerai.cc:5102')
iframeRef.current.contentWindow?.postMessage(readyMessage, 'https://powerai.cc:5103') 
iframeRef.current.contentWindow?.postMessage(readyMessage, '*')

4. WOPIé…ç½®æ­£ç¡®
PostMessageOrigin: 'https://powerai.cc:5101' å‘Šè¯‰CODEå“ªä¸ªåŸŸå¯ä»¥å‘é€PostMessage
è¿™æ˜¯WOPIåè®®çš„å…³é”®é…ç½®

ğŸš€ ç°åœ¨çš„å·¥ä½œæµç¨‹
1ï¼‰WebSocketæ¥æ”¶AgentæŒ‡ä»¤ âœ…
   wss://powerai.cc:5112 â†’ å‰ç«¯

2ï¼‰PostMessage APIæ’å…¥æ–‡æœ¬ âœ…
   å‰ç«¯ â†’ Collabora CODE iframe â†’ æ–‡æ¡£

3ï¼‰å®æ—¶æ˜¾ç¤ºæ•ˆæœ âœ…
   AgentæŒ‡ä»¤ â†’ ç«‹å³æ˜¾ç¤ºåœ¨docxä¸­

ğŸ“Š æŠ€æœ¯æ€»ç»“
ä¹‹å‰å¤±è´¥çš„åŸå› ï¼š
âŒ ä½¿ç”¨äº†éæ ‡å‡†çš„APIæ ¼å¼
âŒ PostMessageç›®æ ‡åœ°å€ä¸æ­£ç¡®
âŒ æ²¡æœ‰æ­£ç¡®åˆå§‹åŒ–Host_PostmessageReady
ç°åœ¨æˆåŠŸçš„åŸå› ï¼š
âœ… ä¸¥æ ¼æŒ‰ç…§å®˜æ–¹æ–‡æ¡£çš„APIæ ¼å¼
âœ… æ­£ç¡®çš„æ¶ˆæ¯è·¯ç”±å’ŒåŸŸé…ç½®
âœ… å®Œæ•´çš„åˆå§‹åŒ–æµç¨‹